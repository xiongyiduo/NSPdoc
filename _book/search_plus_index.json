{"./":{"url":"./","title":"Introduction","keywords":"","body":"Introduction 3dRNA/DNA is a fast and automated method for computationally predicting the 3D structures of RNA and DNA using their sequences and 2D structures as input (Zhang, Wang, and Xiao 2022, 2020; Wang et al. 2019; Zhao et al. 2012). 3dRNA/DNA uses a fragment and template assembly approach to build RNA and DNA 3D structures. According to the given 2D structure, 3dRNA/DNA first decomposes RNA or DNA into different types of smallest secondary elements (SSEs), including helix, hairpin loop, internal loop, bulge loop, pseudoknot loop, and multi-branch loop (also known as junction). Second, for each SSE, 3dRNA/DNA searches for an appropriate 3D template with the same 2D structure and highest sequence similarities from the 3D templates library, which is constructed using 3D structures of various SSEs in experimentally determined RNA and DNA 3D structures, or automatically construct a new template if no templates can be found in the library. Finally, 3dRNA/DNA assembles the 3D templates of all SSEs of the RNA or DNA into an integral 3D structure according to its 2D structure and then carries out a refinement procedure. Since usually one or more 3D templates can be found for each SSE, 3dRNA/DNA can give a set of structural models for an RNA or DNA. The assembled 3D structures can be further optimized with or without constraints of residue-residue interactions or distances by using a coarse-grained energy function (Wang et al. 2017). The predicted models of RNA can be ranked by using 3dRNAscore (Wang et al. 2015), which is an energy function for evaluating predicted 3D structures of RNA in order to pick out the proper ones. It is a knowledge-based statistical potential that combines distance-dependent energy and torsion-angle-dependent energy. The distance-dependent energy is based on distance between two non-bonded heavy atoms located at different residues in the RNA molecule. It is a mean force potential derived from Boltzmann distribution. The torsion-angle-dependent energy is based on the backbone torsion angles in RNA. It is also derived from Boltzmann statistical distribution. 3dRNAscore is included in 3dRNA/DNA but can be used independently but only locally. On the other hand, the predicted models of DNA are evaluated by a coarse-grained energy function extended from that for RNA (Wang et al. 2017). 3dRNA/DNA is extended from 3dRNA v2.0 to include circular RNA and DNA, and is available online (http://biophy.hust.edu.cn/new/3dRNA). In this unit, we will introduce two methods for using 3dRNA/DNA: Web browser (Basic Protocol) and local use (Alternate Protocol) for RNA and DNA 3D structure prediction. For more information Zhao, Y., Y. Huang, Z. Gong, Y. Wang, J. Man, and Y. Xiao. 2012. 'Automated and fast building of three-dimensional RNA structures', Sci Rep, 2: 734 Wang, J., Y. Zhao, C. Zhu, and Y. Xiao. 2015. '3dRNAscore: a distance and torsion angle dependent evaluation function of 3D RNA structures', Nucleic Acids Research, 43: e63. Wang, J., K. K. Mao, Y. J. Zhao, C. Zeng, J. J. Xiang, Y. Zhang, and Y. Xiao. 2017. 'Optimization of RNA 3D structure prediction using evolutionary restraints of nucleotide-nucleotide interactions from direct coupling analysis', Nucleic Acids Research, 45: 6299-309. Wang, Jun, Jian Wang, Yanzhao Huang, and Yi Xiao. 2019. '3dRNA v2.0: An Updated Web Server for RNA 3D Structure Prediction', International Journal of Molecular Sciences, 20: 4116 Zhang, Y., J. Wang, and Y. Xiao. 2020. '3dRNA: Building RNA 3D structure with improved template library', Computational and Structural Biotechnology Journal, 18: 2416-23. Zhang, Y., J. Wang, and Y. Xiao. 2022. '3dRNA: 3D Structure Prediction from Linear to Circular RNAs', Journal of Molecular Biology, 434: 167452. Zhang Y, Xiong Y, Xiao Y. 2022. '3dDNA: A Computational Method of Building DNA 3D Structures', Molecules, 27:5936. "},"install.html":{"url":"install.html","title":"Installation","keywords":"","body":"Installation requirements g++ version is greater than 4.8 Compile and install upgrade g++ If the g++ version is less than 4.8, you need to upgrade the g++ firstly. Here take gcc-4.9.3 as an example: root user wget http://mirror.hust.edu.cn/gnu/gcc/gcc-4.9.3/gcc-4.9.3.tar.gz tar xvzf gcc-4.9.3.tar.gz cd gcc-4.9.3 ./contrib/download_prerequisites mkdir build cd build ../configure --enable-checking=release --enable-languages=c,c++ --disable-multilib make -j4 sudo make install ordinary user wget http://mirror.hust.edu.cn/gnu/gcc/gcc-4.9.3/gcc-4.9.3.tar.gz tar xvzf gcc-4.9.3.tar.gz cd gcc-4.9.3 ./contrib/download_prerequisites mkdir build cd build ../configure --enable-checking=release --enable-languages=c,c++ --disable-multilib --prefix= make -j4 sudo make install download nsp You can download NSP from our webserver or you can input the command below on the command line: wget http://biophy.hust.edu.cn/new/downloads/NSP.tar.gz tar -zxvf NSP.tar.gz Set the environment. export NSP= "},"3dRNA_DNA_web.html":{"url":"3dRNA_DNA_web.html","title":"3dRNA/DNA","keywords":"","body":"3dRNA/DNA Click here to visit 3dRNA/DNA web server You can click \"Example\" to show example: You can find using instructions in the Guide page: You can find tips for each options when click . Here are some examples. The parameters are in the table and the options you need to choose are showing in the picture. Using Default procedure to predict a Linear RNA Key Value Molecule Type RNA RNA Type Linear RNA Procedure Default Task Name 3dRNA_DNA Email example@xxx.com Sequence GGGGAUUGAAAAUCCCC Predict 2nd Strucure No 2D Structure ((((((.....)))))) Number of Predictions 5 Number of Samplings 100 Exclude PDBs 1j4y Loop Building Method Bi-residue Minimization Yes Using Assemble procedure to predict a Circular RNA Key Value Molecule Type RNA RNA Type Circular RNA Procedure Assemble Task Name cirRNA Email example@xxx.com Sequence GGUCAGUUUGAAAAGGAGGAUCGAGCUCACUGUGGAGUAUCCAUG GAGAUGUGGAGCCUUGUCACCAACCUCUAACUGCAGAACUGGGAU GUGGAGCUGGAAGUGCCUCCUCUUCUGGGCUGUGCUGGUCACAGC CACACUCUGCACCGCUAGGCCGUCCCCGACCUUGCCUGAACAAG Predict 2nd Strucure Yes 2nd Structure Prediction Method RNAfold Number of Predictions 5 Number of Samplings No sampling Exclude PDBs Null Loop Building Method Bi-residue Minimization Yes Using Optimize procedure to predict a DNA Key Value Molecule Type DNA Procedure Optimize Task Name 3dRNA_DNA Email Null Sequence TCATTTGGG&AATGA Predict 2nd Strucure No 2D Structure (((((....&))))) Number of Predictions 10 Constraint Type None Exclude PDBs Null Loop Building Method Bi-residue Minimization Yes "},"DCA_web.html":{"url":"DCA_web.html","title":"DCA","keywords":"","body":"DCA Click here to visit DCA web server Direct Coupling Analysis (DCA) is a statistical inference framework used to infer direct co-evolutionary couplings among residue pairs in multiple sequence alignments, which aims at disentangling direct from indirect correlations. Users only need to provide the necessary input and submitted on it. Input The input of this web server can be a single-line-sequence, a fasta formatted single sequence, and Multiple Sequence Alignment(MSA) or raw DCA results. Single-line-sequence The single sequence is in one line, without any addtional spaces and new line characters. CGCUUCAUAUAAUCCUAAUGAUAUGGUUUGGGAGUUUCUACCAAGAGCCUUAAACUCUUGAUUAUGAAGUG Single sequence in fasta format The single sequence can have a label, which is prepended before the sequence. >sample sequence CGCUUCAUAUAAUCCUAAUGAUAUGGUUUGGGAGUUUCUACCAAGAGCCUUAAACUCUUGAUUAUGAAGUG MSA A fasta formatted MSA file can also be the input. It's like this: >CP000851.1/4146892-4146991 -UAAUAUUUACCGUUAACACUUCGUAUAAUCUCAAUGAUAUGGU-UUGAGAGUUUCUACC AAG-AGCCC--UAAACU-CUUGAUUAU--GAAGACUUUACUUUAUGUA- >AANE01000012.1/71437-71536 -AAUUUAGCCGCGAAAUUGCUUCGUAUAAUCCCAAUGAUAUGGU-UUGGGAGUUUCUACC AAG-AACCU--UAAAUU-CUUGAUUAU--GAAGUCUGUAACUUUAUGG- >ABCQ01000013.1/101307-101406 -AACUACGUCAUUAAAUCACUUCGUAUAAUCCCAAUAAUAUGGU-UUGGGAGUUUCUACC AAG-AUCCU--UAAACU-CUUGAUUAU--GAAGUCUGUAACUUUAAAA- >MSA-TARGET -----------------CGCUUCAUAUAAUCCUAAUGAUAUGGU-UUCCGAGUUUCUACC AAG-AGCCU--UAAACU-CUUGAUUAU--GAAGUG-------------- >CP000961.1/1440820-1440919 -GCCUCCACAAAACUUAAGCUUCGUAUAAUCCCAAUGAUAUGGU-UUGGGAGUUUCUACC AAG-AGCCU--UAAAUU-CUUGAUUAU--GAAGUCUGUAGCUUUAUAU- >CR378679.1/147737-147638 -UAAUAAUGGGUAAAGUUACUUCGUAUAACCCCACUUAUAGGGU-GUGGGGGUCUCUACC AGA-AUCCG--UAAAAU-UCUGAUUAC--GAAGAGUUGAGUGAUUGAU- >AAPS01000004.1/87369-87468 -UAUAAUCCCUCUCGUUUGCUUCGUAUAACCCCAAUGAUAUGGU-UUGGGGGUCUCUACC AGU-UCCCG--CAAAGU-GCUGAUUAC--GAAGAGUUGAGAUCAUCGU- >AAWP01000021.1/27378-27279 -GUAUAAUCGCGCCGUUUGCUUCGUAUAACCCCAAUGAUAUGGU-UUGGGGGUCUCUACC -AGCUCCCG--CAAAGUGCU-GAUUAC--GAAGAGUUGAGAUCACUGU- Raw DCA results Our web server can remove some of the false positive values in DCA values, the raw DCA values is like this: 1 2 0.0222606 1 3 0.0244218 1 4 0.00404876 1 5 0.0106655 1 6 0.00497574 1 7 0.00536148 1 8 0.00113751 1 9 0.000536608 1 10 0.00113748 1 11 0.00113745 Output The DCA web server will do computations according to your inputs, the main routines are as below. Seq -> Rfam -> MSA -> DI -> DI* In the above procedures, we use RNA falimiy(Rfam) to get a seed for each single sequence(Seq), and then a MSA method(infernal, MUSCLE or HMMER) is utilized to get the aligned fasta file. Then, we get the raw DI values by plmDCA or mfDCA. Finnaly, a simple routine is used to remove the obvious false positive values of DI values and the clean DI values are obtained(DI*). After the task is finished, the MSA(if the input is single sequence), DCA(if the input is sequence or MSA), and clean DI values will be provided to you. "},"3dRPC_web.html":{"url":"3dRPC_web.html","title":"3dRPC","keywords":"","body":"3dRPC Click here to visit 3dRPC web server 3dRPC is an automatic program of building three-dimensional RNA-protein complex structures by docking RNA and protein structure. The input of the 3dRPC server is the structure of protein and RNA in PDB format: ATOM 84706 N MET V 1 -134.594 111.719 180.266 ATOM 84707 CA MET V 1 -134.339 111.991 178.856 ATOM 84708 C MET V 1 -133.342 113.135 178.673 ATOM 84709 O MET V 1 -133.677 114.186 178.125 ATOM 84710 CB MET V 1 -135.647 112.297 178.123 ATOM 84711 CG MET V 1 -135.482 112.480 176.627 ATOM 84712 SD MET V 1 -134.220 111.380 175.959 ATOM 84713 CE MET V 1 -134.680 109.827 176.724 You can upload the structures by clicking the corresponding buttons. Then, you can input the number of predictions. The 3dRPC server can generate corresponding number of complexes. Finally, submit your job by clicking the \"Submit\" button. Once a job is submitted to the 3dRPC server, a web page is displayed to show the rate of progress and the predicted result if the job is finished. You can download the predicted complex structures in PDB format. "},"ssp.html":{"url":"ssp.html","title":"Secondary Structure Prediction","keywords":"","body":"Secondary Structure Prediction Free energy minimization method nsp ssp_fe -seq Combining free energy minimization method and DI value of the DCA prediction for secondary structure prediction nsp ssp_dca -seq -di [-k ] value is used to set to read the first K·L DI values. If K=1, on behalf of the read before L; if K=0.5, on behalf of the read before L/2. Show secondary structure tree nsp ss_tree -seq -ss \"\" is the sequence, is the secondary structure. Example: nsp ss_tree -seq AAAACCCCUUUU -ss \"((((....))))\" Calculate MCC nsp mcc \"\" \"\" Calculate STY nsp sty \"\" \"\" Calculate PPV nsp ppv \"\" \"\" "},"tsp.html":{"url":"tsp.html","title":"Tertiary Structure Prediction","keywords":"","body":"Tertiary Structure Prediction Use the “assemble” module of nsp to carry out assembly. The user needs to input the command below on the command line: For linear RNA: YOUR_PATH_TO_NSP/RNA/nsp assemble -name -seq -ss \"\" -n For Circular RNA: YOUR_PATH_TO_NSP/cirRNA_and_DNA/nsp assemble -name -seq -ss \"\" -n -circ 1 For DNA:YOUR_PATH_TO_NSP/cirRNA_and_DNA/nsp assemble -name -seq -ss \"\" -n -circ 0 -t DNA This will generate a set of structure files named .pred.pdb, where represents the value from 1 to . is the sequence of RNA or DNA. is the dot-bracket notation of the 2D structure, and must be in quotes. Use the “sample” module of NSP to carry on sampling. The user needs to input the command below on the command line: For linear RNA: YOUR_PATH_TO_NSP/RNA/nsp sample -name -seq -ss \"\" -n -num_samplings For Circular RNA: YOUR_PATH_TO_NSP/cirRNA_and_DNA/nsp sample -name -seq -ss \"\" -n -num_samplings -circ 1 This will sample structural models and cluster them into clusters. Then it will generate a structure file for each cluster named .pred.pdb, where represents the value from 1 to . Use the “opt” module of NSP to carry out optimization. The user needs to input the command below on the command line: For linear RNA: YOUR_PATH_TO_NSP/RNA/nsp opt -name -seq -ss \"\" -init [-dca ] / [-seed ] / [- ] / [-queue ] For Circular RNA: YOUR_PATH_TO_NSP/cirRNA_and_DNA/nsp opt -name -seq -ss \"\" -init [-dca ] / [-seed ] / [- ] / [-queue ] -circ 1 For DNA: YOUR_PATH_TO_NSP/cirRNA_and_DNA/nsp opt -name -seq -ss \"\" -init [-dca ] / [-seed ] / [- ] / [-queue ] -circ 0 -t DNA The optimization is based on the simulated annealing Monte Carlo algorithm. For speed, we use the coarse-grained model that represents a residue by six pseudo atoms: P (representing the phosphate group), C1’, C4’ (representing the sugar ring), C2, C4, and C6 (representing the base). This will generate a structure file named .traj.p1.pdb. JOB_NAME job name SEQUENCE sequence example: AAAAACCCCUUUUU SECONDARY_STRUCTURE secondary structure with dot-bracket notation example: (((((....))))) INITIAL_PDB_FILE initial structure file with 'pdb' or 'cif' format CONSTRAINTS_FILE constraints file example: 8 23 10 9 22 10 10 21 10 The first two column represents the base sequence number, for example 8 represents the eighth base, 23 represents the twenty-third base, the last column is the minimum distance between the base. DCA_FILE dca file CONSTRAINTS_FILE Queue of optimization actions. Optimization action example: Simulated Annealing Monte Carlo simulation samc:200000:20-0.01 Monte Carlo simulation by always heating heat:100000:20 heat:100000 Monte Carlo simulation by always cooling cool:100000:20 cool:100000 Monte Carlo simulation by always warming warm:100000:20 warm:100000 Queue example: heat:30000+warm:100000+cool:1000000 SEED default value of seed is 11 Use the “traj cluster” module of NSP to cluster trajector. The user needs to input the command below on the command line: YOUR_PATH_TO_NSP/RNA/nsp traj cluster .traj.p1.pdb -prefix .cluster -k -aa -o clusters.out -bin This will generate a set of structure files after cluster named .cluster..center.pdb and .cluster..lowest.pdb, where represents the value from 1 to . .traj.p1.pdb is the result of “opt” module. is the size of the step when reading the model of .traj.p1.pdb. the default value of is 1. Add a step “Default” to estimate whether the predicted nucleic acid molecule structure need optimize. Firstly use “assemble” module of NSP, besides the structure file, it will also generate a log file named .p1.log. Then the user needs to input the command below on the command line: For linear RNA: python YOUR_PATH_TO_NSP/RNA/perfect_temp.py -i .p1.log -p “YOUR_PATH_TO_NSP/Lib/” For Circular RNA and DNA: python YOUR_PATH_TO_NSP/cirRNA_and_DNA/perfect_temp.py -i .p1.log -p “YOUR_PATH_TO_NSP/Lib/” If the answer is “True”, it means the predicted structure is already prefect. Otherwise, the user needs to use “opt” module of NSP to optimize the predicted structure. Score a single structure by the “score” module of NSP. The user needs to input the command below on the command line: YOUR_PATH_TO_NSP/RNA/nsp score -s This module can only score RNA, it cannot be used for DNA. Score multiple structures using the “score” module of NSP. The user needs to input the below command in the command line: YOUR_PATH_TO_NSP/RNA/nsp score -s:l The file in the list of contains the name of the structure to cluster. "},"DCA.html":{"url":"DCA.html","title":"Direct Coupling Analysis","keywords":"","body":"Direct Coupling Analysis Mean field DCA nsp dca -method mf -in -out -n Message propogation DCA nsp dca -method mp -in -out -n Pseudo-likelyhood DCA nsp dca -method plm -in -out -n "},"Utilities.html":{"url":"Utilities.html","title":"Utilities","keywords":"","body":"Utilities Clustering nsp cluster -list -k Set the structures that need to cluster with -list and set the amount with -k. After a period of operation, the structure of the cluster will be printed out on the screen. The file contains the name of the structure to cluster. Calculating RMSD nsp rmsd Get the sequence of the molecule nsp seq Get the secondary structure of the molecule nsp ss Get the number of residues in the molecule nsp len Get of specified residues in the molecul nsp sub -num ... Each frag refers to a base segment, the format is a single residue number n or the specified starting point and end point of the fragment begin-end. for example, 1 represents the first residue, and 4-11 represents a fragment of fourth to eleventh bases. Only residues A, U, G and C are retained nsp rna Only residues A, U, G and C containing the complete atoms are retained nsp rna -format "}}